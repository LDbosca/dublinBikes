<!DOCTYPE html>
<html>
<head>
<script src="https://code.jquery.com/jquery-3.3.1.js">
</script>
</head>
<body>
    
<!--HTML element to hold the map:!-->
<div id="googleMap" style="width:100%;height:500px;"></div>
    

<script>
    
function myMap() {
//The mapProp variable defines the properties for the map.
var mapProp= {
  center:new google.maps.LatLng(53.350140, -6.266155), //center in Dublin
  zoom:12,
};
//creates a new map inside the <div> element using the parameters that are passed (mapProp).
var map = new google.maps.Map(document.getElementById("googleMap"),mapProp);

 
//using jQuery to import JSON filefrom url and pass it to the function 
$.getJSON('http://127.0.0.1:5000/stations', function (data) {
    displayStation(data);
});

    
function displayStation(obj) {
    // variable that contains station information
    var stations = obj;
    
    //static infoWindow for all your markers
    var infowindow = new google.maps.InfoWindow(); 
    // loop that iterates through the object and extract information
    for(var i = 0; i < stations.length; i++){
      var loc = new google.maps.LatLng(stations[i].stationLat, stations[i].stationLong);
      var content = '<div><p> Station Name:  ' + stations[i].stationName + '</p><p> Total bike stands:  ' + stations[i].stationStands + '</p><p> Credit Card accepted:  ' + stations[i].stationBanking + '</p><p> Available bike stands:  ' + stations[i].stationStdsAvailable + '</p><p> Available bikes: ' + stations[i].stationBikesAvailable + '</p></div>';
      var marker = new google.maps.Marker({
         position: loc,
         map: map,
         title: stations[i].name
      });
        
    google.maps.event.addListener(marker,'click', (function(marker,content,infowindow){ 
        return function() {
           infowindow.setContent(content);
           infowindow.open(map,marker);
        };
    })(marker,content,infowindow)); 
        
    }     
}
}

</script>

<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDMsv7Vw1OJPpTQ2rb6NtrjYykltKPbti4&callback=myMap">
</script>

</body>
</html>